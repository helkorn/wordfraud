<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WordPorn</title>
    <style>
        @font-face {
            font-family: 'C64';
            src: url('fontC64.ttf') format('truetype');
        }
        @font-face {
            font-family: 'Typewriter';
            src: url('fontTW.ttf') format('truetype');
        }
        body {
            font-family: Arial, sans-serif;
            background-color: #000;
            color: #fff;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }
        .container {
            max-width: 800px;
            text-align: center;
            padding: 20px;
            border: 1px solid #333;
            border-radius: 10px;
            background-color: #111;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
        }
        h1 {
            color: #fff;
            font-size: 2em;
            margin-bottom: 20px;
        }
        .timer {
            font-size: 1.5em;
            margin-bottom: 20px;
        }
        input[type="text"] {
            width: 80%;
            padding: 10px;
            font-size: 16px;
            margin-bottom: 10px;
            border: 1px solid #333;
            border-radius: 5px;
            background-color: #222;
            color: #fff;
            text-align: center;
        }
        button {
            padding: 5px 10px;
            font-size: 14px;
            cursor: pointer;
            border: 1px solid #333;
            border-radius: 50px;
            background-color: #333;
            color: #fff;
            transition: background-color 0.3s;
            margin-top: 10px;
        }
        button:hover {
            background-color: #555;
        }
        .result {
            margin-top: 20px;
            font-size: 1.2em;
            color: #f00;
        }
        .link-box {
            position: fixed;
            top: 40px;
            right: 20px;
            font-size: 14px;
            color: #fff;
            white-space: nowrap;
            text-align: right;
        }
        .link-box a {
            color: #fff;
            text-decoration: none;
        }
        .link-box a:hover {
            text-decoration: underline;
        }
        .hidden {
            display: none;
        }
        .typewriter-box {
            position: absolute;
            top: 40px;
            right: 20px;
            background-color: #f5f5f5;
            color: #000;
            padding: 10px;
            border: 1px solid #333;
            border-radius: 5px;
            font-family: 'Typewriter', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            width: 200px; /* Leveys, joka vastaa noin neljää sanaa */
        }
    </style>
</head>
<body>
    <div class="link-box" id="whatIsThisLink">
        <a href="javascript:void(0)" onclick="showAnalgrammi()">What is this?</a>
    </div>
    <div class="container">
        <h1>WordPorn</h1>
        <p>Analgrammit. Mitä nyt vittua taas.</p>
        <div class="timer" id="timer">60</div>
        <input type="text" id="answer" placeholder="Kirjoita vastaus">
        <div>
            <button id="solveButton" onclick="checkAnswer()">RATKAISE</button>
            <button id="revealButton" onclick="loadNewWord()">PALJASTA</button>
        </div>
        <div class="result" id="result"></div>
    </div>

    <script>
        let words = new Set();
        let currentWord = '';
        let timer;
        let timeLeft = 60;

        function startTimer() {
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    loadNewWord();
                }
            }, 1000);
        }

        function shuffleWord(word) {
            let shuffledWord = word.split('').sort(() => Math.random() - 0.5).join('');
            while (shuffledWord === word) {
                shuffledWord = word.split('').sort(() => Math.random() - 0.5).join('');
            }
            return shuffledWord;
        }

        function loadNewWord() {
            const wordsArray = Array.from(words);
            currentWord = wordsArray[Math.floor(Math.random() * wordsArray.length)];
            const shuffledWord = shuffleWord(currentWord);
            document.getElementById('answer').placeholder = shuffledWord;
            document.getElementById('answer').value = '';
            timeLeft = 60;
            document.getElementById('timer').textContent = timeLeft;
            startTimer();
        }

        function checkAnswer() {
            const answer = document.getElementById('answer').value.trim().toLowerCase();
            if (answer === currentWord.toLowerCase()) {
                document.getElementById('result').textContent = 'Oikein!';
                clearInterval(timer);
                setTimeout(() => {
                    document.getElementById('result').textContent = '';
                    loadNewWord();
                }, 2000);
            } else {
                document.getElementById('result').textContent = 'Väärin!';
            }
        }

        function showAnalgrammi() {
            const linkBox = document.getElementById('whatIsThisLink');
            linkBox.innerHTML = '';
            const box = document.createElement('div');
            box.id = 'typewriterBox';
            box.className = 'typewriter-box';
            document.body.appendChild(box);
            const text = 'Analgrammi on helppo peli erityisen vanhoille kuten sinä.\n\nKaikki sanat ovat alatyylisiä kuten sinä.\n\nSanassa on kirjaimet menneet sekaisin kuten sinä.\n\nSiksi se on epäselvä kuin sinä.\n\nKäytä luovuutta jota sinulla ei ole.\n\nMuodosta oikea vastaus sanalla joka on helppo kuin sinä.\n\nJos keksit sen, ihan ok, mutta silloinkin kaikki arvauksesi ovat olleet alatyylisiä kuin sinäkin.\n\nKello nopeutuu joka vastauksesta joka on pielessä, kuten sinä.\n\nOnnea peliin, joka on kuin Analgrammi.';
            let index = 0;

            function typeNext() {
                if (index < text.length) {
                    box.textContent += text[index];
                    index++;
                    let delay = 50;
                    if (text[index - 1] === ' ' || text[index - 1] === '\n') {
                        delay = 200; // Pidempi tauko sanan jälkeen
                    }
                    setTimeout(typeNext, delay);
                }
            }

            typeNext();
        }

        document.addEventListener('DOMContentLoaded', () => {
            Papa.parse('https://raw.githubusercontent.com/timosalonen/wordfraud/main/wordpornFI.csv', {
                download: true,
                complete: function(results) {
                    results.data.flat().map(word => word.trim()).filter(Boolean).forEach(word => {
                        words.add(word.toLowerCase());
                    });
                    loadNewWord();
                }
            });
        });
    </script>
</body>
</html>
