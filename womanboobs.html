<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WomanBoobs24</title>
    <style>
        @font-face {
            font-family: 'C64';
            src: url('fontC64.ttf') format('truetype');
        }
        @font-face {
            font-family: 'Typewriter';
            src: url('fontTW.ttf') format('truetype');
        }
        body {
            font-family: Arial, sans-serif;
            background-color: #000;
            color: #fff;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }
        .container {
            max-width: 800px;
            text-align: center;
            padding: 20px;
            border: 1px solid #333;
            border-radius: 10px;
            background-color: #111;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 5px;
            margin: 20px 0;
        }
        .grid div {
            width: 30px;
            height: 30px;
            background-color: #222;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2em;
            cursor: pointer;
            user-select: none;
        }
        .grid div.correct {
            background-color: red;
        }
        .attempts {
            margin-top: 20px;
            font-size: 1.2em;
        }
        .corner-image {
            position: fixed;
            bottom: 10px;
            left: 10px;
            width: 50px;
            height: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>WomanBoobs24</h1>
        <p>Neliö kirjaimia. Etsi oikeat sanat!</p>
        <div class="grid" id="grid"></div>
        <div class="attempts" id="attempts">Yritykset: 10</div>
    </div>
    <img src="titpics/Pink_ribbon.svg" alt="Pink Ribbon" class="corner-image">

    <script>
        const gridSize = 10;
        const attemptsElement = document.getElementById('attempts');
        let attempts = 10;
        let words = [];
        let correctLetters = [];

        function loadWords() {
            fetch('melonit.csv')
                .then(response => response.text())
                .then(text => {
                    words = text.split('\n').map(word => word.trim()).filter(Boolean);
                    initializeGrid();
                });
        }

        function initializeGrid() {
            const grid = document.getElementById('grid');
            const letters = 'abcdefghijklmnopqrstuvwxyzåäö';
            let gridLetters = [];

            // Add random letters
            for (let i = 0; i < gridSize * gridSize; i++) {
                gridLetters.push(letters[Math.floor(Math.random() * letters.length)]);
            }

            // Insert words into the grid
            words = shuffleArray(words).slice(0, 10); // Pick 10 random words
            words.forEach(word => {
                let placed = false;
                while (!placed) {
                    const startX = Math.floor(Math.random() * gridSize);
                    const startY = Math.floor(Math.random() * gridSize);
                    const direction = Math.random() < 0.5 ? 'horizontal' : 'vertical';

                    if (canPlaceWord(word, startX, startY, direction)) {
                        placeWord(word, startX, startY, direction);
                        placed = true;
                    }
                }
            });

            // Display the grid
            grid.innerHTML = '';
            for (let i = 0; i < gridSize * gridSize; i++) {
                const cell = document.createElement('div');
                cell.textContent = gridLetters[i];
                cell.addEventListener('click', () => handleLetterClick(cell, gridLetters[i]));
                grid.appendChild(cell);
            }
        }

        function canPlaceWord(word, x, y, direction) {
            if (direction === 'horizontal') {
                if (x + word.length > gridSize) return false;
                for (let i = 0; i < word.length; i++) {
                    if (correctLetters.includes(`${x + i},${y}`)) return false;
                }
            } else {
                if (y + word.length > gridSize) return false;
                for (let i = 0; i < word.length; i++) {
                    if (correctLetters.includes(`${x},${y + i}`)) return false;
                }
            }
            return true;
        }

        function placeWord(word, x, y, direction) {
            if (direction === 'horizontal') {
                for (let i = 0; i < word.length; i++) {
                    correctLetters.push(`${x + i},${y}`);
                }
            } else {
                for (let i = 0; i < word.length; i++) {
                    correctLetters.push(`${x},${y + i}`);
                }
            }
        }

        function handleLetterClick(cell, letter) {
            const index = [...cell.parentNode.children].indexOf(cell);
            const x = index % gridSize;
            const y = Math.floor(index / gridSize);

            if (correctLetters.includes(`${x},${y}`)) {
                cell.classList.add('correct');
                checkForCompletedWord();
            } else {
                attempts--;
                attemptsElement.textContent = `Yritykset: ${attempts}`;
                if (attempts <= 0) {
                    alert('Peli ohi!');
                    location.reload();
                }
            }
        }

        function checkForCompletedWord() {
            // This function can be implemented to check if a word is completely found
            // and provide appropriate feedback to the player
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        document.addEventListener('DOMContentLoaded', loadWords);
    </script>
</body>
</html>
